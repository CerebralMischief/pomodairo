<?xml version="1.0" encoding="utf-8"?>
<mx:Canvas xmlns:mx="http://www.adobe.com/2006/mxml" width="248" height="50" 
	creationComplete="init()" borderColor="#000000" borderStyle="solid" backgroundColor="#000000" showEffect="fadein" hideEffect="fadeout">
	
	<mx:Script>
        <![CDATA[
        	import com.pomodairo.Pomodoro;
        	import com.pomodairo.events.PomodoroEvent;
        	import com.pomodairo.PomodoroEventDispatcher;
        
        	public var type:String = Pomodoro.TYPE_POMODORO;
        	public var reference:Pomodoro;
        	
        	private function init():void {
				input.addEventListener(KeyboardEvent.KEY_DOWN,checkSubmit);
				trace("SET FOCUS");
				input.setFocus();
			}
           
           function checkSubmit(event:KeyboardEvent):void
            {
                if(event.charCode == 13)
                       fireSubmit(null);
            }
            
			private function fireSubmit(event:Event):void
	        {
	        	trace("SUBMIT: "+input.text);
	        	var interruption:Pomodoro = new Pomodoro();
	        	interruption.name = input.text;
	        	if (reference != null) {
	        		interruption.parent = reference.id;
	        	} else {
	        		interruption.parent = 0;
	        	}
	        	interruption.type = type;
	        	
	        	var evt:PomodoroEvent = new PomodoroEvent(PomodoroEvent.INTERRUPTION)
	        	evt.pomodoro = reference;
	        	evt.other = interruption;
	        	
	        	PomodoroEventDispatcher.getInstance().dispatchEvent(evt);
	        	this.parent.removeChild(this);
	        } 
	        
        ]]>
    </mx:Script>
    
    <mx:Fade id="fadein" duration="1000" alphaFrom="0" alphaTo="1.0"/>
	<mx:Fade id="fadeout" duration="1000"  alphaFrom="1.0" alphaTo="0.0"/>
	
	<mx:TextInput id="input" width="226" x="10" y="10" backgroundColor="#000000" color="#FFFFFF" fontSize="14" height="28" showEffect="fadein" hideEffect="fadeout"/>
	
</mx:Canvas>
